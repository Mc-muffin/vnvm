SHELL         = /bin/sh

# Compiler and compiler/preprocessor flags
CC            = @CC@
OPTIMIZE      = @OPTIMIZE@
EXTRA_CFLAGS  = @EXTRA_CFLAGS@
INCLUDE_DIRS  = -I.. @INCLUDE_DIRS@
DEFINES       = @DEFINES@
CFLAGS        = $(OPTIMIZE) $(EXTRA_CFLAGS)
CPPFLAGS      = $(INCLUDE_DIRS) $(DEFINES)

# Linker flags
EXTRA_LDFLAGS = @EXTRA_LDFLAGS@
LDFLAGS       = -L.. -lmpeg $(EXTRA_LDFLAGS)

# Executables to build
EXTRAS        = @extras@

# Library file (need to check that it's up-to-date)
LIBRARY       = ../libmpeg.a

# Implicit targets
.c.o:
		$(CC) -c $(CFLAGS) $(CPPFLAGS) $< $?

# Explicit targets

all:            $(EXTRAS)

mpegtest:	$(LIBRARY) mpegtest.o ParseArgv.o
		$(CC) $(CFLAGS) mpegtest.o ParseArgv.o -o $@ $(LDFLAGS)

easympeg:	$(LIBRARY) easympeg.o
		$(CC) $(CFLAGS) easympeg.o -o $@ -lgl $(LDFLAGS)

$(LIBRARY):
		(cd .. ; make lib)

clean:
		rm -f mpegtest easympeg
		rm -f mpegtest.o ParseArgv.o easympeg.o mpegtest easympeg

distclean:
		rm -f Makefile
